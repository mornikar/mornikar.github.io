<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Dr.GT_Mornikar</title><link rel="icon" type="image/x-icon" href="../../../../../favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="../../../../../font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="../../../../../font/BenderLight.woff2"><link rel="preload" as="font" crossorigin="anonymous" href="../../../../../font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="../../../../../css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/font/BenderLight.ttf");
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><meta name="page-config" content="{&quot;code_fold&quot;:null}"><script class="pjax-js">var config = {"root":"/","code_fold":15,"search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}};
var page_config = {
  code_fold: null
};
function updatePageConfig() {
  var newPageConfig = document.querySelector('meta[name="page-config"]');
  if (newPageConfig) {
    page_config = JSON.parse(newPageConfig.content);
  }
}
document.addEventListener('pjax:complete', function() { updatePageConfig(); });
updatePageConfig();</script><link type="text/css" rel="stylesheet" href="../../../../../lib/encrypt/hbe.style.css"><script src="//unpkg.com/mermaid@10.5.0/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="../../../../../lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.woff2") format('woff2');
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
 --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
 --light-background: url('../../../../../img/bk.jpg');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="../../../../../js/arknights.js"></script><script defer src="../../../../../js/search.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@10.5.0/dist/mermaid.esm.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="../../../../../lib/encrypt/hbe.js"></script><script async src="../../../../../js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.vercount','meta[name=page-config]'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
const postBg = document.querySelector('#post-bg');
if (postBg) lightGallery(postBg, {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.vercount','meta[name=page-config]'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="atom.xml" title="Dr.GT_Mornikar" type="application/atom+xml">
</head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="../../../../../"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="../../../../../archives"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="../../../../../LearningNote"><span class="navItemTitle">LearningNote</span></a></li><li class="navItem"><a class="navBlock" href="../../../../../LearningEssays"><span class="navItemTitle">LearningEssays</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1></h1></div><hr><div id="post-content"><p>创建Series</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs clean"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd <br>s = pd.Series([<span class="hljs-string">&#x27;banana&#x27;</span>,<span class="hljs-number">42</span>])<br></code></pre></td></tr></table></figure>
<p>创建DataFrame</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stylus">name_list = pd<span class="hljs-selector-class">.DataFrame</span>(<br>	&#123;<br>		<span class="hljs-string">&#x27;Name&#x27;</span>:<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;Tome&#x27;</span>,<span class="hljs-string">&#x27;Bob&#x27;</span>]</span>, <br>		<span class="hljs-string">&#x27;Occupation&#x27;</span>:<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;Teacher&#x27;</span>,<span class="hljs-string">&#x27;IT Engineer&#x27;</span>]</span>, <br>		<span class="hljs-string">&#x27;age&#x27;</span>:<span class="hljs-selector-attr">[28,36]</span><br>	&#125;<br>)<br></code></pre></td></tr></table></figure>
<h1 id="Series-常用操作"><a href="#Series-常用操作" class="headerlink" title="Series 常用操作"></a>Series 常用操作</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs stylus">loc	使用索引值取子集<br>iloc 	使用索引位置取子集<br>dtype或dtypes Series	内容的类型<br>T 	Series的转置矩阵<br>shape 	数据的维数<br>size 	Series中元素的数量<br>values 	Series的值<br><span class="hljs-selector-class">.value_counts</span>()		统计value数量<br>director<span class="hljs-selector-class">.count</span>() 	返回非空值<br><span class="hljs-function"><span class="hljs-title">describe</span><span class="hljs-params">()</span></span> 	打印描述信息<br></code></pre></td></tr></table></figure>
<h1 id="Series的一些方法"><a href="#Series的一些方法" class="headerlink" title="Series的一些方法"></a>Series的一些方法</h1><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs mathematica">方法 	说明<br><span class="hljs-variable">append</span> 	连接两个或多个<span class="hljs-built_in">Series</span><br><span class="hljs-variable">corr</span> 	计算与另一个<span class="hljs-built_in">Series</span>的相关系数<br><span class="hljs-variable">cov</span>	 计算与另一个<span class="hljs-built_in">Series</span>的协方差<br><span class="hljs-variable">describe</span> 计算常见统计量<br><span class="hljs-type">drop_duplicates</span> 	返回去重之后的<span class="hljs-built_in">Series</span><br><span class="hljs-variable">equals</span> 		判断两个<span class="hljs-built_in">Series</span>是否相同<br><span class="hljs-type">get_values</span> 	获取<span class="hljs-built_in">Series</span>的值，作用与<span class="hljs-variable">values</span>属性相同<br><span class="hljs-variable">hist</span> 	绘制直方图<br><span class="hljs-variable">isin</span> <span class="hljs-built_in">Series</span>	中是否包含某些值<br><span class="hljs-variable">min</span> 	返回最小值<br><span class="hljs-variable">max</span>	返回最大值<br><span class="hljs-variable">mean</span>	返回算术平均值<br><span class="hljs-variable">median</span>	返回中位数<br><span class="hljs-variable">mode</span> 	返回众数<br><span class="hljs-variable">quantile</span> 	返回指定位置的分位数<br><span class="hljs-variable">replace</span> 	用指定值代替<span class="hljs-built_in">Series</span>中的值<br><span class="hljs-variable">sample</span>	 返回<span class="hljs-built_in">Series</span>的随机采样值<br><span class="hljs-type">sort_values</span> 	对值进行排序<br><span class="hljs-type">to_frame</span>	把<span class="hljs-built_in">Series</span>转换为<span class="hljs-variable">DataFrame</span><br><span class="hljs-variable">unique</span> 		去重返回数组<br></code></pre></td></tr></table></figure>
<p>两个Series之间计算，如果Series元素个数相同，则将两个Series对应元素进行计算；元素不同则缺失用NaN表示</p>
<h1 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ndim 查看数集的维度<br>set_index 修改索引<br>drop 删除列<br>to_pickle 保存<br>read_pickle 读取<br>to_csv  保存成csv文件<br>格式：(<span class="hljs-string">&#x27;output/scientists_df.tsv&#x27;</span>,sep=<span class="hljs-string">&#x27;\t&#x27;</span>)<br><br><br><br>to_clipboard 把数据保存到系统剪贴板，方便粘贴<br>to_dict 把数据转换成Python字典<br>to_hdf 把数据保存为HDF格式<br>to_html 把数据转换成HTML<br>to_json 把数据转换成JSON字符串<br>to_sql 把数据保存到SQL数据库<br><br><span class="hljs-function"><span class="hljs-title">nlargest</span><span class="hljs-params">(<span class="hljs-number">100</span>,<span class="hljs-string">&#x27;imdb_score&#x27;</span>)</span></span><br><br><span class="hljs-number">0.1</span><br>统计数值列，并进行转置<br>college<span class="hljs-selector-class">.describe</span>()<span class="hljs-selector-class">.T</span><br><br>统计多方式数值<br><span class="hljs-selector-class">.describe</span>()<br><br>nlargest方法显示出某列的排序<br><span class="hljs-function"><span class="hljs-title">nlargest</span><span class="hljs-params">(<span class="hljs-number">100</span>,<span class="hljs-string">&#x27;imdb_score&#x27;</span>)</span></span><span class="hljs-selector-class">.head</span>()<br><br>传入一个字典<br><span class="hljs-function"><span class="hljs-title">agg</span><span class="hljs-params">(<span class="hljs-string">&#x27;key&#x27;</span>:<span class="hljs-string">&#x27;value&#x27;</span>)</span></span><br></code></pre></td></tr></table></figure>
<h1 id="聚合重点"><a href="#聚合重点" class="headerlink" title="聚合重点"></a>聚合重点</h1><p>agg</p>
<h1 id="数据链接"><a href="#数据链接" class="headerlink" title="数据链接"></a>数据链接</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs stylus">concat	把<span class="hljs-built_in">dataframe</span>(简单叠堆)<br>ignore_index = True	忽略后面DataFrame的索引<br><br>添加列（默认添加行）<br>，传入参数 axis = <span class="hljs-attribute">columns</span><br>col_concat = pd<span class="hljs-selector-class">.concat</span>(<span class="hljs-selector-attr">[df1,df2,df3]</span>,axis=<span class="hljs-number">1</span>)<br><br>向DataFrame添加一列，不需要调用函数，通过dataframe<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;列名&#x27;</span>]</span> = <span class="hljs-selector-attr">[<span class="hljs-string">&#x27;值&#x27;</span>]</span> 即可<br><br></code></pre></td></tr></table></figure>
<h1 id="链接数据库"><a href="#链接数据库" class="headerlink" title="链接数据库"></a>链接数据库</h1><p>pd.read_sql_table<br>从数据库中读取表，第一个参数是表名，第二个参数是数据库连接对象</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs sql">how <span class="hljs-operator">=</span> ’<span class="hljs-keyword">left</span>‘ 对应<span class="hljs-keyword">SQL</span>中的 <span class="hljs-keyword">left</span> <span class="hljs-keyword">outer</span> 保留左侧表中的所有key<br>how <span class="hljs-operator">=</span> ’<span class="hljs-keyword">right</span>‘ 对应<span class="hljs-keyword">SQL</span>中的 <span class="hljs-keyword">right</span> <span class="hljs-keyword">outer</span> 保留右侧表中的所有key<br>how <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;outer&#x27;</span> 对应<span class="hljs-keyword">SQL</span>中的 <span class="hljs-keyword">full</span> <span class="hljs-keyword">outer</span> 保留左右两侧侧表中的所有key<br>how <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;inner&#x27;</span> 对应<span class="hljs-keyword">SQL</span>中的 <span class="hljs-keyword">inner</span> 只保留左右两侧都有的key<br><br>转换：<br>to_timedelta 将Milliseconds列转变为timedelta数据类型<br>dt.<span class="hljs-built_in">floor</span>(<span class="hljs-string">&#x27;s&#x27;</span>) dt.<span class="hljs-built_in">floor</span>() 时间类型数据，按指定单位截断数据<br><br>DataFrame的assign方法：创建新列<br>.assign<br><br><span class="hljs-keyword">join</span>合并，依据两个DataFrame的行索引，如果合并的两个数据有相同的列名，需要通过lsuffix，和rsuffix，指定合并后的列名<br>的前缀<br>stocks_2016.join(stocks_2017, lsuffix<span class="hljs-operator">=</span><span class="hljs-string">&#x27;_2016&#x27;</span>, rsuffix<span class="hljs-operator">=</span><span class="hljs-string">&#x27;_2017&#x27;</span>, how<span class="hljs-operator">=</span><span class="hljs-string">&#x27;outer&#x27;</span>)<br><br>concat, <span class="hljs-keyword">join</span>, 和<span class="hljs-keyword">merge</span>的区别<br><br>concat ：<br>Pandas函数<br>可以垂直和水平地连接两个或多个pandas对象<br>只用索引对齐<br>默认是外连接（也可以设为内连接）<br><span class="hljs-keyword">join</span> ：<br>DataFrame方法<br>只能水平连接两个或多个pandas对象<br>对齐是靠被调用的DataFrame的列索引或行索引和另一个对象的行索引（不能是列索引）<br>通过笛卡尔积处理重复的索引值<br>默认是左连接（也可以设为内连接、外连接和右连接）<br><span class="hljs-keyword">merge</span> ：<br>DataFrame方法<br>只能水平连接两个DataFrame对象<br>对齐是靠被调用的DataFrame的列或行索引和另一个DataFrame的列或行索引<br>通过笛卡尔积处理重复的索引值<br>默认是内连接（也可以设为左连接、外连接、右连接）<br></code></pre></td></tr></table></figure>

<h1 id="缺失数据处理"><a href="#缺失数据处理" class="headerlink" title="缺失数据处理"></a>缺失数据处理</h1><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">keep_default_na = <span class="hljs-keyword">False</span> 关闭NaN显示<br>ffill 填充，用时间序列中空值的上一个非空值填充<br>city_day.fillna(<span class="hljs-keyword">method</span>=&#x27;<span class="hljs-title function_">ffill</span>&#x27;,<span class="hljs-title function_">inplace</span>=<span class="hljs-title function_">True</span>) <span class="hljs-title function_">city_day</span>[&#x27;<span class="hljs-title function_">Xylene</span>&#x27;][50:<span class="hljs-number">65</span>]<br>用时间序列中空值的下一个非空值填充<br><span class="hljs-keyword">method</span>=&#x27;<span class="hljs-title function_">bfill</span>&#x27;<br>线性差值方法<br><span class="hljs-title function_">limit_direction</span>=&quot;<span class="hljs-title function_">both</span>&quot;<br></code></pre></td></tr></table></figure>
<h1 id="整理数据"><a href="#整理数据" class="headerlink" title="整理数据"></a>整理数据</h1><p>melt<br>既可以用pd.melt, 也可使用dataframe.melt()</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs smali">frame dataframe 被 melt 的数据集名称在 pd.melt() 中使用<br>id_vars tuple/list/ndarray 	可选项不需要被转换的列名，在转换后作为标识符列（不是索引列）<br>value_vars tuple/list/ndarray 	可选项需要被转换的现有列如果未指明，除 id_vars 之外的其他列都被转换<br>var_name string variable 	默认值自定义列名名称设置由 &#x27;value_vars&#x27; 组成的新的 column name<br>value_name string value 	默认值自定义列名名称设置由 &#x27;value_vars&#x27; 的数据组成的新的 column name<br>col_level<span class="hljs-built_in"> int/string </span>	可选项如果列是MultiIndex，则使用此级别<br><br>数据整理（函数自动处理）<br>pew_long = pd.melt(pew,id_vars=&#x27;religion&#x27;)<br>pew_long<br></code></pre></td></tr></table></figure>
<h1 id="处理查询冗余"><a href="#处理查询冗余" class="headerlink" title="处理查询冗余"></a>处理查询冗余</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs stylus">对于同一首歌曲来说，歌曲信息是完全一样的，可以考虑单独保存歌曲信息<br>减少上表中保存的歌曲信息，可以节省存储空间，需要完整信息的时候，可以通过merge拼接数据<br>我们可以把year,artist,track,time和date.entered放入一个新的dataframe中<br><br><span class="hljs-number">1</span>.提取表信息，进行去重<br>illboard_songs = bill_borad_long<span class="hljs-selector-attr">[[<span class="hljs-string">&#x27;year&#x27;</span>,<span class="hljs-string">&#x27;artist&#x27;</span>,<span class="hljs-string">&#x27;track&#x27;</span>,<span class="hljs-string">&#x27;time&#x27;</span>,<span class="hljs-string">&#x27;date.entered&#x27;</span>]</span>] billboard_songs = billboard_songs<span class="hljs-selector-class">.drop_duplicates</span>()<br>billboard_songs<br><br><span class="hljs-number">2</span>.为新拆分处理出来的数据添加ID列（添加ID）<br>billboard_songs<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;id&#x27;</span>]</span> = <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(billboard_songs)) <br>billboard_songs<br><br><span class="hljs-number">3</span>.数据拆分成两个dataframe：billboard_songs和 billboard_ratings<br>取出每周评分，去掉冗余部分<br>billboard_ratings = bill_borad_long<span class="hljs-selector-class">.merge</span>(billboard_songs,on=<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;year&#x27;</span>,<span class="hljs-string">&#x27;artist&#x27;</span>,<span class="hljs-string">&#x27;track&#x27;</span>,<span class="hljs-string">&#x27;time&#x27;</span>,<span class="hljs-string">&#x27;date.entered&#x27;</span>]</span>) billboard_ratings = billboard_ratings<span class="hljs-selector-attr">[[<span class="hljs-string">&#x27;id&#x27;</span>,<span class="hljs-string">&#x27;week&#x27;</span>,<span class="hljs-string">&#x27;rating&#x27;</span>]</span>] billboard_ratings<br><br><span class="hljs-number">4</span>.用merage还原数据<br>billboard_songs<span class="hljs-selector-class">.merge</span>(billboard_ratings,on=<span class="hljs-selector-attr">[<span class="hljs-string">&#x27;id&#x27;</span>]</span>)<br><br></code></pre></td></tr></table></figure>
<h1 id="stack整理数据"><a href="#stack整理数据" class="headerlink" title="stack整理数据"></a>stack整理数据</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">用rename_axis给不同的行索引层级命名<br><span class="hljs-function"><span class="hljs-title">reset_index</span><span class="hljs-params">()</span></span>，将结果变为DataFrame<br></code></pre></td></tr></table></figure>
<h1 id="wide-to-long整理数据"><a href="#wide-to-long整理数据" class="headerlink" title="wide_to_long整理数据"></a>wide_to_long整理数据</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">stubs = [<span class="hljs-string">&#x27;actor&#x27;</span>, <span class="hljs-string">&#x27;actor_facebook_likes&#x27;</span>]<br>actor2_tidy = pd.wide_to_long(actor2, <span class="hljs-attribute">stubnames</span>=stubs, i=[<span class="hljs-string">&#x27;movie_title&#x27;</span>], <span class="hljs-attribute">j</span>=<span class="hljs-string">&#x27;actor_num&#x27;</span>, <span class="hljs-attribute">sep</span>=<span class="hljs-string">&#x27;_&#x27;</span>).reset_index() <br>actor2_tidy.head()<br></code></pre></td></tr></table></figure>
<h1 id="unstack-处理数据"><a href="#unstack-处理数据" class="headerlink" title="unstack 处理数据"></a>unstack 处理数据</h1><p>之前介绍了stack，unstack可以将stack的结果恢复</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">state_fruit<span class="hljs-selector-class">.stack</span>()<span class="hljs-selector-class">.unstack</span>()<br></code></pre></td></tr></table></figure>


<h1 id="自定义方法"><a href="#自定义方法" class="headerlink" title="自定义方法"></a>自定义方法</h1><p>.apply(方法名)</p>
<h1 id="向量函数"><a href="#向量函数" class="headerlink" title="向量函数"></a>向量函数</h1><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs gml">def avg_2_mod(<span class="hljs-variable language_">x</span>,<span class="hljs-variable language_">y</span>):<br> 	<span class="hljs-keyword">if</span>(<span class="hljs-variable language_">x</span>==<span class="hljs-number">20</span>): <br>		<span class="hljs-keyword">return</span> (np.<span class="hljs-symbol">NaN</span>) <br>	<span class="hljs-keyword">else</span>:<span class="hljs-keyword">return</span> (<span class="hljs-variable language_">x</span>+<span class="hljs-variable language_">y</span>)/<span class="hljs-number">2</span> <br>avg_2_mod(df[<span class="hljs-string">&#x27;a&#x27;</span>],df[<span class="hljs-string">&#x27;b&#x27;</span>])<br>上面函数中, <span class="hljs-variable language_">x</span>==<span class="hljs-number">20</span> , <span class="hljs-variable language_">x</span> 是向量, 但<span class="hljs-number">20</span>是标量, 不能直接计算. 这个时候可以使用np.vectorize将函数向量化<br>使用装饰器<br>@np.vectorize <br>def vec_avg_2_mod(<span class="hljs-variable language_">x</span>,<span class="hljs-variable language_">y</span>): <br>	<span class="hljs-keyword">if</span>(<span class="hljs-variable language_">x</span>==<span class="hljs-number">20</span>):<br>		 <span class="hljs-keyword">return</span> (np.<span class="hljs-symbol">NaN</span>) <br>	<span class="hljs-keyword">else</span>:<br>		<span class="hljs-keyword">return</span> (<span class="hljs-variable language_">x</span>+<span class="hljs-variable language_">y</span>)/<span class="hljs-number">2</span> <br>vec_avg_2_mod(df[<span class="hljs-string">&#x27;a&#x27;</span>],df[<span class="hljs-string">&#x27;b&#x27;</span>])<br></code></pre></td></tr></table></figure>
<h1 id="lambda函数"><a href="#lambda函数" class="headerlink" title="lambda函数"></a>lambda函数</h1><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gml">df.apply(lambda <span class="hljs-variable language_">x</span>: <span class="hljs-variable language_">x</span>+<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>
<h1 id="Pandas内置的聚合方法"><a href="#Pandas内置的聚合方法" class="headerlink" title="Pandas内置的聚合方法"></a>Pandas内置的聚合方法</h1><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs maxima">Pandas	方法 Numpy函数 说明<br>count 	<span class="hljs-built_in">np</span>.count_nonzero 	频率统计(不包含NaN值)<br>size 	频率统计(包含NaN值)<br><span class="hljs-built_in">mean</span> <span class="hljs-built_in">np</span>.<span class="hljs-built_in">mean</span> 	求平均值<br><span class="hljs-built_in">std</span> <span class="hljs-built_in">np</span>.<span class="hljs-built_in">std</span> 	标准差<br><span class="hljs-built_in">min</span> <span class="hljs-built_in">np</span>.<span class="hljs-built_in">min</span> 	最小值<br><span class="hljs-built_in">quantile</span>() 	<span class="hljs-built_in">np</span>.percentile() 	分位数<br><span class="hljs-built_in">max</span> <span class="hljs-built_in">np</span>.<span class="hljs-built_in">max</span> 	求最大值<br><span class="hljs-built_in">sum</span> <span class="hljs-built_in">np</span>.<span class="hljs-built_in">sum</span> 	求和<br><span class="hljs-built_in">var</span> <span class="hljs-built_in">np</span>.<span class="hljs-built_in">var</span> 	方差<br><span class="hljs-built_in">describe</span> 	计数、平均值、标准差，最小值、分位数、最大值<br><span class="hljs-built_in">first</span> 	返回第一行<br><span class="hljs-built_in">last</span> 	返回最后一行<br>nth 返回第N行(Python从<span class="hljs-number">0</span>开始计数)<br></code></pre></td></tr></table></figure>
<p>agg<br>agg.(‘列名’:’方法名’).rename(‘原名’：’新名’)</p>
<h1 id="转换"><a href="#转换" class="headerlink" title="转换"></a>转换</h1><p>transform 转换，需要把DataFrame中的值传递给一个函数， 而后由该函数”转换”数据。<br>aggregate(聚合) 返回单个聚合值，但transform 不会减少数据量</p>
<figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gml"># 计算z-<span class="hljs-variable language_">score</span> <span class="hljs-variable language_">x</span> - 平均值/标准差 <br>def my_zscore(<span class="hljs-variable language_">x</span>): <br>	<span class="hljs-keyword">return</span> (<span class="hljs-variable language_">x</span>-<span class="hljs-variable language_">x</span>.<span class="hljs-built_in">mean</span>())/<span class="hljs-variable language_">x</span>.std()<br> #按年分组 计算z-<span class="hljs-variable language_">score</span> <br>df.groupby(<span class="hljs-string">&#x27;year&#x27;</span>).lifeExp.transform(my_zscore)<br></code></pre></td></tr></table></figure>
<h1 id="transform分组填充缺失值"><a href="#transform分组填充缺失值" class="headerlink" title="transform分组填充缺失值"></a>transform分组填充缺失值</h1><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs haskell">之前介绍了填充缺失值的各种方法，对于某些数据集，可以使用列的平均值来填充缺失值。某些情况下，可以考虑将列进行分组，分<br>组之后取平均再填充缺失值<br><span class="hljs-title">tips_10</span> = pd.read_csv(&#x27;<span class="hljs-class"><span class="hljs-keyword">data</span>/tips.csv&#x27;).sample(10,<span class="hljs-title">random_state</span> = 42) </span><br><span class="hljs-title">tips_10</span><br><br></code></pre></td></tr></table></figure><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="../%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/">← Next </a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="../Numpy/"> Prev →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a><a onclick="BgmControl()"><svg id="bgm-control" viewBox="0 0 30 34" fill="currentColor" style="width: 24px; transition: transform .3s;margin-top: 4px"><path d="M25.998 23.422V11.29h3.999v12.132h-3.999zM19.497 6.234h4.001v22.243h-4.001V6.234zM12.998.867h4v32.978h-4V.867zm-6.5 5.367h4.001v22.243H6.498V6.234zm-6.5 5.056h4v12.132h-4V11.29z"></path></svg><audio id="bgm" src="/audio/bgm.mp3" crossorigin="anonymous"> </audio></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo" style="margin:0;border-radius:0;"></a><h1 id="Dr"><a href="/">Mornikar</a></h1><div id="description"><p>It is time to get up and make efforts</p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Series-%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">1.</span> <span class="toc-text">Series 常用操作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Series%E7%9A%84%E4%B8%80%E4%BA%9B%E6%96%B9%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">Series的一些方法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DataFrame"><span class="toc-number">3.</span> <span class="toc-text">DataFrame</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E9%87%8D%E7%82%B9"><span class="toc-number">4.</span> <span class="toc-text">聚合重点</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%93%BE%E6%8E%A5"><span class="toc-number">5.</span> <span class="toc-text">数据链接</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%93%BE%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">6.</span> <span class="toc-text">链接数据库</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BC%BA%E5%A4%B1%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-number">7.</span> <span class="toc-text">缺失数据处理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B4%E7%90%86%E6%95%B0%E6%8D%AE"><span class="toc-number">8.</span> <span class="toc-text">整理数据</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E6%9F%A5%E8%AF%A2%E5%86%97%E4%BD%99"><span class="toc-number">9.</span> <span class="toc-text">处理查询冗余</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#stack%E6%95%B4%E7%90%86%E6%95%B0%E6%8D%AE"><span class="toc-number">10.</span> <span class="toc-text">stack整理数据</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#wide-to-long%E6%95%B4%E7%90%86%E6%95%B0%E6%8D%AE"><span class="toc-number">11.</span> <span class="toc-text">wide_to_long整理数据</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#unstack-%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE"><span class="toc-number">12.</span> <span class="toc-text">unstack 处理数据</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%96%B9%E6%B3%95"><span class="toc-number">13.</span> <span class="toc-text">自定义方法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%90%91%E9%87%8F%E5%87%BD%E6%95%B0"><span class="toc-number">14.</span> <span class="toc-text">向量函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lambda%E5%87%BD%E6%95%B0"><span class="toc-number">15.</span> <span class="toc-text">lambda函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pandas%E5%86%85%E7%BD%AE%E7%9A%84%E8%81%9A%E5%90%88%E6%96%B9%E6%B3%95"><span class="toc-number">16.</span> <span class="toc-text">Pandas内置的聚合方法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A2"><span class="toc-number">17.</span> <span class="toc-text">转换</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#transform%E5%88%86%E7%BB%84%E5%A1%AB%E5%85%85%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-number">18.</span> <span class="toc-text">transform分组填充缺失值</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr> by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr><wbr><nobr> Build Time<script>const buildTime = new Date("2025-09-12T18:04:15.280Z");
document.write(' ' + buildTime.toLocaleString());</script></nobr></footer></aside></main><canvas id="canvas-dust"></canvas></body></html>